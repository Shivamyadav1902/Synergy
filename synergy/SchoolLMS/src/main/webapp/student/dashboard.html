<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Dashboard - School LMS</title>
    <link rel="stylesheet" href="../css/style.css">
</head>

<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="navbar-brand">ðŸŽ“ School LMS</div>
        <ul class="navbar-menu">
            <li><a href="dashboard.html">Dashboard</a></li>
            <li><a href="courses.html">My Courses</a></li>
            <li><a href="assignments.html">Assignments</a></li>
            <li><a href="grades.html">Grades</a></li>
            <li><a href="attendance.html">Attendance</a></li>
            <li><a href="#" onclick="logout()">Logout</a></li>
        </ul>
    </nav>

    <!-- Main Content -->
    <div class="container">
        <h1 class="mb-2">Student Dashboard</h1>
        <p class="text-secondary mb-2" id="welcomeMessage">Welcome back!</p>

        <!-- Stats Cards -->
        <div class="grid grid-4 mb-2">
            <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                <div class="stat-value" id="totalCourses">0</div>
                <div class="stat-label">Enrolled Courses</div>
            </div>

            <div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                <div class="stat-value" id="pendingAssignments">0</div>
                <div class="stat-label">Pending Assignments</div>
            </div>

            <div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                <div class="stat-value" id="avgGrade">-</div>
                <div class="stat-label">Average Grade</div>
            </div>

            <div class="stat-card" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                <div class="stat-value" id="attendanceRate">-</div>
                <div class="stat-label">Attendance</div>
            </div>
        </div>

        <!-- Enrolled Courses -->
        <div class="card mb-2">
            <div class="card-header">
                <h2 class="card-title">My Courses</h2>
            </div>
            <div id="coursesList">
                <p class="text-secondary">Loading courses...</p>
            </div>
        </div>

        <!-- Recent Announcements -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">ðŸ“¢ Recent Announcements</h2>
            </div>
            <div id="announcementsList">
                <p class="text-secondary">No announcements at this time.</p>
            </div>
        </div>
    </div>

    <script src="../js/script.js"></script>
    <script>
        // Load dashboard data
        async function loadDashboard() {
            try {
                const data = await apiRequest('/api/dashboard');

                if (data && data.user) {
                    document.getElementById('welcomeMessage').textContent =
                        `Welcome back, ${data.user.fullName}!`;

                    // Update stats
                    document.getElementById('totalCourses').textContent =
                        data.totalEnrollments || 0;

                    // Load enrolled courses
                    if (data.enrolledCourses && data.enrolledCourses.length > 0) {
                        const coursesList = document.getElementById('coursesList');
                        coursesList.innerHTML = '';

                        data.enrolledCourses.forEach(enrollment => {
                            const courseCard = document.createElement('div');
                            courseCard.className = 'card';
                            courseCard.style.marginBottom = '1rem';
                            courseCard.innerHTML = `
                                <h3 style="margin-bottom: 0.5rem;">${enrollment.courseName}</h3>
                                <p style="color: var(--text-secondary); font-size: 0.875rem;">
                                    Status: <span class="badge badge-${enrollment.status === 'ACTIVE' ? 'success' : 'primary'}">
                                        ${enrollment.status}
                                    </span>
                                </p>
                                <p style="color: var(--text-muted); font-size: 0.875rem;">
                                    Enrolled: ${formatDate(enrollment.enrollmentDate)}
                                </p>
                            `;
                            coursesList.appendChild(courseCard);
                        });
                    } else {
                        document.getElementById('coursesList').innerHTML =
                            '<p class="text-secondary">You are not enrolled in any courses yet.</p>';
                    }
                }
            } catch (error) {
                console.error('Error loading dashboard:', error);
                showAlert('Failed to load dashboard data', 'error');
            }
        }

        // Load on page ready
        document.addEventListener('DOMContentLoaded', loadDashboard);
    </script>
</body>

</html>